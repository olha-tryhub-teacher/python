import pandas as pd
df = pd.read_csv('GooglePlayStore_wild.csv')
# –í–∏–≤–µ–¥–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–µ—Å—å DataFrame, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫—ñ —Å—Ç–æ–≤–ø—Ü—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –æ—á–∏—â–µ–Ω–Ω—è
print("üëΩ 2.2 –ó–∞–≥–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—èüëΩ")
print(df.info())


# –°–∫—ñ–ª—å–∫–∏ –≤ –¥–∞—Ç–∞—Å–µ—Ç—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤, —É —è–∫–∏—Ö –Ω–µ –≤–∫–∞–∑–∞–Ω–æ (NaN) —Ä–µ–π—Ç–∏–Ω–≥ (Rating)?
print("üëΩ 2.3 –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ä–æ–∂–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å —É —Å—Ç–æ–≤–ø—Ü—ñ RatingüëΩ")
print(len(df[pd.isnull(df['Rating'])]))
# –ó–∞–º—ñ–Ω–∏ –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è ('NaN') —Ä–µ–π—Ç–∏–Ω–≥—É ('Rating') –¥–ª—è —Ç–∞–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –Ω–∞ -1.
print("üëΩ–ó–∞–º—ñ–Ω—è—î–º–æ  –ø–æ—Ä–æ–∂–Ω—ñ –∑–∞–Ω–∞—á–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—É –Ω–∞ -1 üëΩ")
df['Rating'].fillna(-1, inplace=True)
print("–¢–µ–ø–µ—Ä –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ä–æ–∂–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å –¥–æ—Ä—ñ–≤–Ω—é—î: ", len(df[pd.isnull(df['Rating'])]))


# –í–∏–∑–Ω–∞—á, —è–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É ('Size') –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –¥–∞—Ç–∞—Å–µ—Ç—ñ –∫—Ä—ñ–º –ö—ñ–ª–æ–±–∞–π—Ç—ñ–≤ —ñ –ú–µ–≥–∞–±–∞–π—Ç—ñ–≤, –∑–∞–º—ñ–Ω–∏ –π–æ–≥–æ –Ω–∞ -1.
# –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏ —Ä–æ–∑–º—ñ—Ä–∏ –¥–æ–¥–∞—Ç–∫—ñ–≤ ('Size') —É —á–∏—Å–ª–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç (float). –†–æ–∑–º—ñ—Ä —É—Å—ñ—Ö –ø—Ä–æ–≥—Ä–∞–º –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–º—ñ—Ä—é–≤–∞—Ç–∏—Å—è –≤ –ú–µ–≥–∞–±–∞–π—Ç–∞—Ö.
print("üëΩ–ó–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ —î –≤ —Å—Ç–æ–≤–ø—á–∏–∫—É Size\n—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤, —â–æ —Ç–∞–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—èüëΩ")
print(df['Size'].value_counts())

# —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞–Ω–Ω—è –∫—ñ–ª–æ–±–∞–π—Ç—ñ–≤ —É –º–µ–≥–∞–±–∞–π—Ç–∏ —Ç–∞ –ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è "–ú"
def set_size(size):
   if size[-1] == 'M':
      return float(size[:-1])
   elif size[-1] == 'k':
      return float(size[:-1]) / 1024
   return -1

df['Size'] = df['Size'].apply(set_size)

print("üëΩ222 –ó–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ —î –≤ —Å—Ç–æ–≤–ø—á–∏–∫—É Size\n—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤, —â–æ —Ç–∞–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—èüëΩ")
print(df['Size'].value_counts())

# –ß–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä ('Size') –¥–æ–¥–∞—Ç–∫—ñ–≤ —ñ–∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó ('Category') 'TOOLS'?
print("üëΩ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –¥–æ–¥–∞—Ç–∫—ñ–≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó TOOLS üëΩ")
print(df[df['Category'] == 'TOOLS']['Size'].max())

#–ë–æ–Ω—É—Å–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è
# –ó–∞–º—ñ–Ω–∏ —Ç–∏–ø –¥–∞–Ω–∏—Ö –Ω–∞ —Ü—ñ–ª–∏–π (int) –¥–ª—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É—Å—Ç–∞–Ω–æ–≤–æ–∫ ('Installs').
# –£ –∑–∞–ø–∏—Å—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É—Å—Ç–∞–Ω–æ–≤–æ–∫ ('Installs') –∑–Ω–∞–∫ "+" –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏.
# –¢–æ–±—Ç–æ. —è–∫—â–æ –≤ –¥–∞—Ç–∞—Å–µ—Ç—ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–æ–∫ –¥–æ—Ä—ñ–≤–Ω—é—î 1,000,000+, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ 1000000
#
# —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è –∑–∞–π–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ —É Installs
def set_installs(installs):
   if installs == '0':
       return 0
   return int(installs[:-1].replace(',', ''))
df['Installs'] = df['Installs'].apply(set_installs)


# –ó–≥—Ä—É–ø—É–π –¥–∞–Ω—ñ –∑–∞ —Ç–∏–ø–æ–º ('Type') —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—é –∞—É–¥–∏—Ç–æ—Ä—ñ—î—é ('Content Rating') –±—É–¥—å-—è–∫–∏–º –∑—Ä—É—á–Ω–∏–º –¥–ª—è —Ç–µ–±–µ —Å–ø–æ—Å–æ–±–æ–º,
# –ü–æ—Ä–∞—Ö—É–π —Å–µ—Ä–µ–¥–Ω—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–æ–∫ ('Installs') —É –∫–æ–∂–Ω—ñ–π –≥—Ä—É–ø—ñ. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫—Ä—É–≥–ª–∏–ª–∏ –¥–æ –¥–µ—Å—è—Ç–∏—Ö.
# –í –æ—Ç—Ä–∏–º–∞–Ω—ñ–π —Ç–∞–±–ª–∏—Ü—ñ –∑–Ω–∞–π–¥–∏ –∫–æ–º—ñ—Ä–∫—É –∑ –Ω–∞–π–±—ñ–ª—å—à–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º.
# –î–æ —è–∫–æ—ó –≤—ñ–∫–æ–≤–æ—ó –≥—Ä—É–ø–∏ —Ç–∞ —Ç–∏–ø—É –¥–æ–¥–∞—Ç–∫—ñ–≤ –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è –¥–∞–Ω—ñ –∑ —Ü—ñ—î—ó –∫–æ–º—ñ—Ä–∫–∏?

print("üëΩ –°–µ—Ä–µ–¥–Ω—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–æ–∫ —É –∫–æ–∂–Ω—ñ–π –≥—Ä—É–ø—ñ üëΩ")
print(round(df.pivot_table(index='Content Rating', columns='Type', values='Installs', aggfunc='mean')), 1)


# –Ø–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ –≤–∫–∞–∑—É—î —Ç–∏–ø ('Type')? –Ø–∫–∏–π —Ç–∏–ø –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ü—ñ–Ω–∏?
print("üëΩ –Ø–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–µ –≤–∫–∞–∑—É—î —Ç–∏–ø üëΩ")
print(df[pd.isnull(df['Type'])].iloc[0])
print("üëΩüëΩ")
print(df[pd.isnull(df['Type'])])
#–©–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –≤—Å—ñ —Å—Ç–æ–≤–ø—Ü—ñ –∑–∞–º—ñ—Å—Ç—å –∫—Ä–∞–ø–∫–∏, –º–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ iloc[0].

print("üëΩüëΩ")
df['Type'].fillna('Free', inplace=True)


#–í–∏–≤–µ–¥–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–µ—Å—å DataFrame, —â–æ–± –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –æ—á–∏—â–µ–Ω–Ω—è –ø—Ä–æ–π—à–ª–æ —É—Å–ø—ñ—à–Ω–æ
print("üëΩüëΩ")
print(df.info())
