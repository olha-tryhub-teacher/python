import pandas as pd
df = pd.read_csv('GoogleApps.csv')
pd.set_option('display.max_columns', 20)
pd.set_option('display.width', 1000)


# 1 –í–∏–≤–µ–¥–∏ –Ω–∞ –µ–∫—Ä–∞–Ω –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π, —Å–µ—Ä–µ–¥–Ω—ñ–π —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ ('Rating') –ø–ª–∞—Ç–Ω–∏—Ö —Ç–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º ('Type') –∑ —Ç–æ—á–Ω—ñ—Å—Ç—é –¥–æ –¥–µ—Å—è—Ç–∏—Ö.
print("üíÖüèª–ó–∞–≤–¥–∞–Ω–Ω—è 1üíÖüèª")
res = df.groupby(by="Type")["Rating"].agg(["min", "mean", "max"])
print(round(res, 1))

# 2 –í–∏–≤–µ–¥–∏ –Ω–∞ –µ–∫—Ä–∞–Ω –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É, –º–µ–¥—ñ–∞–Ω–Ω—É (median) —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É —Ü—ñ–Ω—É ('Price') –ø–ª–∞—Ç–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤ (Type == 'Paid') –¥–ª—è
# —Ä—ñ–∑–Ω–∏—Ö —Ü—ñ–ª—å–æ–≤–∏—Ö –∞—É–¥–∏—Ç–æ—Ä—ñ–π ('Content Rating')
print("üíÖüèª–ó–∞–≤–¥–∞–Ω–Ω—è 2üíÖüèª")
res = df[df["Type"] == "Paid"].groupby(by="Content Rating")["Price"].agg(["min", "median", "max"])
print(res)

# 3 –ó–≥—Ä—É–ø—É–π –¥–∞–Ω—ñ –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é ('Category') —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—é –∞—É–¥–∏—Ç–æ—Ä—ñ—î—é ('Content Rating') –±—É–¥—å-—è–∫–∏–º –∑—Ä—É—á–Ω–∏–º –¥–ª—è —Ç–µ–±–µ —Å–ø–æ—Å–æ–±–æ–º
# –ü–æ—Ä–∞—Ö—É–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤ ('Reviews') —É –∫–æ–∂–Ω—ñ–π –≥—Ä—É–ø—ñ.
# –ü–æ—Ä—ñ–≤–Ω—è–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π 'EDUCATION', 'FAMILY' —Ç–∞ 'GAME':
# –£ —è–∫—ñ–π –≤—ñ–∫–æ–≤—ñ–π –≥—Ä—É–ø—ñ –Ω–∞–π–±—ñ–ª—å—à–µ –≤—ñ–¥–≥—É–∫—ñ–≤ –æ—Ç—Ä–∏–º–∞–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó 'EDUCATION'? 'FAMILY'? 'GAME'?
# –ü—ñ–¥–∫–∞–∑–∫–∞: —Ç–∏ –º–æ–∂–µ—à –≤–∏–±—Ä–∞—Ç–∏ –∑ DataFrame –∫—ñ–ª—å–∫–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É:
# df [[<—Å—Ç–æ–≤–ø–µ—Ü—å 1>, <—Å—Ç–æ–≤–ø–µ—Ü—å 2>, <—Å—Ç–æ–≤–ø–µ—Ü—å 3>]]
print("üíÖüèª–ó–∞–≤–¥–∞–Ω–Ω—è 3üíÖüèª")
res = df.pivot_table(index='Content Rating', columns='Category', values='Reviews', aggfunc='max')
print(res[['EDUCATION', 'FAMILY', 'GAME']])


# 4 –ó–≥—Ä—É–ø—É–π –ø–ª–∞—Ç–Ω—ñ (Type == 'Paid') –ø—Ä–æ–≥—Ä–∞–º–∏ –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é ('Category') —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—é –∞—É–¥–∏—Ç–æ—Ä—ñ—î—é ('Content Rating')
# –ü–æ—Ä–∞—Ö—É–π —Å–µ—Ä–µ–¥–Ω—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–≥—É–∫—ñ–≤ ('Reviews') —É –∫–æ–∂–Ω—ñ–π –≥—Ä—É–ø—ñ
# –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤ –¥–µ—è–∫–∏—Ö –∫–ª—ñ—Ç–∏–Ω–∫–∞—Ö –æ—Ç—Ä–∏–º–∞–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–µ —á–∏—Å–ª–æ, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è "NaN" - Not a Number
# –¶–µ–π –∑–∞–ø–∏—Å –æ–∑–Ω–∞—á–∞—î, —â–æ –≤ —Ü—ñ–π –≥—Ä—É–ø—ñ –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏.
# –í–∏–±–µ—Ä–∏ –Ω–∞–∑–≤–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π, –≤ —è–∫–∏—Ö —î –ø–ª–∞—Ç–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –¥–ª—è –≤—Å—ñ—Ö –≤—ñ–∫–æ–≤–∏—Ö –≥—Ä—É–ø —ñ —Ä–æ–∑—Ç–∞—à—É–π —ó—Ö –≤ –∞–ª—Ñ–∞–≤—ñ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É.
print("üíÖüèª–ó–∞–≤–¥–∞–Ω–Ω—è 4üíÖüèª")
res = df[df["Type"] == "Paid"].pivot_table(index="Category", columns="Content Rating", values="Reviews", aggfunc="mean")
print(res)

# –ë–æ–Ω—É—Å–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è. –ó–Ω–∞–π–¥–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏—Ö (Type == 'Free') –¥–æ–¥–∞—Ç–∫—ñ–≤,
# —É —è–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–∏ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω—ñ –Ω–µ –¥–ª—è –≤—Å—ñ—Ö –≤—ñ–∫–æ–≤–∏—Ö –≥—Ä—É–ø ('Content Rating')
print("üíÖüèª–ë–æ–Ω—É—Å–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—èüíÖüèª")
res = df[df["Type"] == "Free"].pivot_table(index="Category", columns="Content Rating", values="Reviews", aggfunc="mean")
print(res)
